<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pocket Jobs</title>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Raleway:100,300,500,700" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Baloo+Chettan+2:wght@500&family=Inconsolata:wght@900&family=Pangolin&family=Luckiest+Guy&family=Rokkitt:wght@500&display=swap" rel="stylesheet"> 
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css" />
        <link rel="stylesheet" href="/css/app.css">
</head>
<body>
<div class="wrapper">
        {{>sidebar}}
        <div id="content">
            <section class="headTohead">
                <div id="header" class="headTohead__header py-2 px-5 mb-4 container-fluid">
                    <h1 class="display-4">Head To Head</h1>
                    <p class="lead d-none d-sm-block">The accumulation of all Head-To-Head regular season matchups from the year 2018 and beyond.</p>                  
                </div>
            </section>
            <main class="container-fluid">
                <div class="row">
                    <div class="col-lg-7">
                        <div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="team team__1">
                                        <div class="team__totals team__totals-1">
                                            <div class="team__image team__image-1"></div>
                                            <select class="form-control team__selector team__selector--1" name="team-1" id="left">
                                                <option class="team__selector-option" value="true">Select a team</option>
                                                <option class="team__selector-option" value="1">Kevin</option>
                                                <option class="team__selector-option" value="2">Duncan</option>
                                                <option class="team__selector-option" value="3">Matt</option>
                                                <option class="team__selector-option" value="4">Nick</option>
                                                <option class="team__selector-option" value="5">Conner</option>
                                                <option class="team__selector-option" value="6">Morgan</option>
                                                <option class="team__selector-option" value="7">Seth</option>
                                                <option class="team__selector-option" value="8">Erik</option>
                                            </select>
                                            <h2 id="left__wins" class="team__record team__record-1">-</h2>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="team team__2">
                                        <div class="team__totals team__totals-2">
                                            <div class="team__image team__image-1"></div>
                                            <select name="team-2" id="right" class="form-control team__selector team__selector--2">
                                                <option class="team__selector-option" value="true">Select a team</option>
                                                <option class="team__selector-option" value="1">Kevin</option>
                                                <option class="team__selector-option" value="2">Duncan</option>
                                                <option class="team__selector-option" value="3">Matt</option>
                                                <option class="team__selector-option" value="4">Nick</option>
                                                <option class="team__selector-option" value="5">Conner</option>
                                                <option class="team__selector-option" value="6">Morgan</option>
                                                <option class="team__selector-option" value="7">Seth</option>
                                                <option class="team__selector-option" value="8">Erik</option>
                                            </select>
                                            <h2 id="right__wins" class="team__record team__record-2">-</h2>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="container-fluid mb-4">
                                <div class="row">
                                    <div class="col">
                                        <div class="row team__stats hidden">
                                            <div class="col-6">
                                                <div class="div">
                                                    <div class="team__numbers team__numbers-1">
                                                        <p id="left_points">
                                                            <strong>Total Points</strong>
                                                            <span></span>
                                                            
                                                        </p>
                                                         <p id="left_mvp">
                                                            <strong>Starting MVP</strong>
                                                            <span>N/A</span>
                                                        </p>
                                                         <p id="left_bmvp">
                                                            <strong>Bench MVP</strong>
                                                            <span>N/A</span>
                                                        </p>
                                                         <p id="left_low">
                                                            <strong>Lowest Margin</strong>
                                                            <span>N/A</span>
                                                        </p>
                                                         <p id="left_high">
                                                            <strong>Highest Margin</strong>
                                                            <span>N/A</span>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="div">
                                                    <div class="team__numbers team__numbers-2">
                                                        <p id="right_points"></p>
                                                        <p id="right_mvp">N/A</p>
                                                        <p id="right_bmvp">N/A</p>
                                                        <p id="right_low">N/A</p>
                                                        <p id="right_high">N/A</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                        
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <div class="table__wrapper">
                            <table class="table__gameLogs" id="gameLogs">
                                <thead>
                                    <tr>
                                        <th>Season</th>
                                        <th>Week</th>
                                        <th>Team 1</th>
                                        <th>Team 2</th>
                                        <th>Winner</th>
                                        <th>MVP</th>
                                    </tr>
                                </thead>
                                <tbody>

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
    </div>
</div>




        {{!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script> --}}
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
        <script src="bootstrap/dist/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>

        <script>

            var left = 0;
            var right = 0;


            $('#left').change(function() {
                left = $(this).children('option:selected').val();
            })

            $('#right').change(function() {
                right = $(this).children('option:selected').val();
            })

            function insertDate(year, week) {
                var markup = '<td>'+ year +' Season,' + 'Week ' + week + '</td>';
                return markup;
            }

            function insertGame(teamA,teamAScore,teamB,teamBScore) {
                var markup = '<td> ' + teamA + ' ' + teamAScore + ', ' + teamB + ' ' + teamBScore;
                    return markup;
            }



            $('select').change(function() {
                if (left >= 1 && right >= 1){

                    $('.team__stats').removeClass('hidden');
                    $('.team__stats').addClass('visible');


                const hostId = this.id
                console.log(hostId);
                $.post('/headTohead', {leftId: left, rightId: right}, function(data) {

                    console.log(data);


                    $('#left_points').children('span').text(data.left.hostScore)
                    $('#leftTeamName').children('span').text(data.right.oppName)
                    $('#left__wins').text(data.left.wins)
                    $('#left_mvp').children('span').text(`${data.left.hostStartingMVP}  (${data.left.hostStartingMVPScore})`)
                    $('#left_bmvp').children('span').text(`${data.left.hostBenchMVP}  (${data.left.hostBenchMVPScore})`)
                    $('#left_low').children('span').text(data.left.lowestMargin)
                    $('#left_high').children('span').text(data.left.largestMargin)
                    
                    $('#right_points').text(data.right.hostScore)
                    $('#rightTeamName').text(data.left.oppName)
                    $('#right__wins').text(data.right.wins)
                    $('#right_mvp').text(`${data.right.hostStartingMVP}  (${data.right.hostStartingMVPScore})`)
                    $('#right_bmvp').text(`${data.right.hostBenchMVP}  (${data.right.hostBenchMVPScore})`)
                    $('#right_low').text(data.right.lowestMargin)
                    $('#right_high').text(data.right.largestMargin)

                    $('#gameLogs tbody').empty();

                    for(var i = 0; i <data.games.length; i++) {
                        var mvp;
                        var mvpScore;
                        var winner;
                        if(data.games[i].win === true){
                            mvp = data.games[i].hostStartingMVP;
                            mvpScore = data.games[i].hostStartingMVPScore;
                            winner = data.right.oppName;
                        }
                        else{
                            mvp = data.games[i].oppStartingMVP;
                            mvpScore = data.games[i].oppStartingMVPScore;
                            winner = data.games[i].oppName;
                        }

                        var seasonMarkup = '<td>'+ data.games[i].seasonId + '</td>';
                        var weekMarkup = '<td>'+ data.games[i].scoringPeriodId + '</td>';
                        var teamLeftMarkup = '<td>'+ data.right.oppName + ' ' + data.games[i].hostScore + '</td>';
                        var teamRightMarkup = '<td>'+ data.games[i].oppName + ' ' + data.games[i].oppScore + '</td>';
                        var winnerMarkup = '<td>'+ winner + '</td>';
                        var mvpMarkup = `<td> ${mvp}  (${mvpScore.toFixed(1)}) </td>`;

                        console.log(winner)
                        console.log(mvpScore)

                        //var game = '<td> ' + data.right.oppName + ' ' + data.games[i].hostScore + ', ' + data.games[i].oppName + ' ' + data.games[i].oppScore + '</td>';
                        //console.log(date)
                        //console.log(game)

                        $('#gameLogs tbody').append('<tr>' + seasonMarkup + weekMarkup + teamLeftMarkup + teamRightMarkup + winnerMarkup + mvpMarkup + '</tr>')

                    }


                });
                }
                else{
                }
            })

        </script>


</body>
</html>